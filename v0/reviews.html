<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" id="modeCSS" type="text/css" href="./assets/css/styles.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css">
  <title>ZyFeronix Studio</title>
  <script>
    fetch('/menu.json')
      .then(response => response.json())
      .then(menu => {
        const menuItems = Object.entries(menu);
        const menuDropdown = document.querySelector('.menu-dropdown');
        const removeHtmlExtension = url => url.replace('.html', '');

        menuItems.forEach(([key, value]) => {
          const menuItem = document.createElement('a');
          menuItem.href = value.url;
          menuItem.textContent = value.title;
          menuDropdown.appendChild(menuItem);

          const currentUrlWithoutExtension = removeHtmlExtension(window.location.pathname);
          if (currentUrlWithoutExtension === removeHtmlExtension(value.url)) {
            menuItem.classList.add('active');
          }
        });
      })
      .catch(error => {
        console.error('Error al cargar el menú:', error);
      });
  </script>
</head>

<body>
  <header class="header">
    <div class="header-content">
      <div class="modeSwitch">
        <label class="switch">
          <span class="sun"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <g fill="#ffd43b">
                <circle r="5" cy="12" cx="12"></circle>
                <path d="m21 13h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm-17 0h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm13.66-5.66a1 1 0 0 1 -.66-.29 1 1 0 0 1 0-1.41l.71-.71a1 1 0 1 1 1.41 1.41l-.71.71a1 1 0 0 1 -.75.29zm-12.02 12.02a1 1 0 0 1 -.71-.29 1 1 0 0 1 0-1.41l.71-.66a1 1 0 0 1 1.41 1.41l-.71.71a1 1 0 0 1 -.7.24zm6.36-14.36a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm0 17a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm-5.66-14.66a1 1 0 0 1 -.7-.29l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.29zm12.02 12.02a1 1 0 0 1 -.7-.29l-.66-.71a1 1 0 0 1 1.36-1.36l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.24z"></path>
              </g>
            </svg></span>
          <span class="moon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
              <path d="m223.5 32c-123.5 0-223.5 100.3-223.5 224s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
            </svg></span>
          <input type="checkbox" class="input">
          <span class="slider"></span>
        </label>
      </div>
      <button class="menu-btn">&#9776;</button>
      <div class="menu-dropdown">
      </div>
      <h1>ZyFeronix Studio</h1>
      <p>Donde la única limitación es nuestra imaginación y el café nuestro motor!</p>
      <div class="scroll-arrow" data-scroll-to="about">
        <span class="arrow-text">Reviews</span>
        <span class="arrow">&#8595;</span>
      </div>
    </div>
  </header>
  <section class="about fade-in" id="about">
    <h2>Opiniones de usuarios</h2>
    <br>
    <div class="opinions-container">
    </div>
  </section>
  <section class="contacts fade-in" id="contacts">
    <h2>Deja tu comentario</h2>
    <form id="commentForm">
      <label for="name">Nombre:</label>
      <input type="text" id="name" name="name" required>

      <label for="review">Puntuación (del 0 al 5):</label>
      <input type="number" id="review" name="review" min="0" max="5" required><br><br>

      <label for="description">Comentario:</label>
      <textarea id="description" name="description" required></textarea>

      <button type="submit">Enviar comentario</button>
    </form>
  </section>
  <section class="footer fade-in">
    <br>
    <div class="elevator">
      <svg class="sweet-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve" height="100px" width="100px">
        <path d="M70,47.5H30c-1.4,0-2.5,1.1-2.5,2.5v40c0,1.4,1.1,2.5,2.5,2.5h40c1.4,0,2.5-1.1,2.5-2.5V50C72.5,48.6,71.4,47.5,70,47.5z   M47.5,87.5h-5v-25h5V87.5z M57.5,87.5h-5v-25h5V87.5z M67.5,87.5h-5V60c0-1.4-1.1-2.5-2.5-2.5H40c-1.4,0-2.5,1.1-2.5,2.5v27.5h-5  v-35h35V87.5z" />
        <path d="M50,42.5c1.4,0,2.5-1.1,2.5-2.5V16l5.7,5.7c0.5,0.5,1.1,0.7,1.8,0.7s1.3-0.2,1.8-0.7c1-1,1-2.6,0-3.5l-10-10  c-1-1-2.6-1-3.5,0l-10,10c-1,1-1,2.6,0,3.5c1,1,2.6,1,3.5,0l5.7-5.7v24C47.5,41.4,48.6,42.5,50,42.5z" />
      </svg>
    </div>
    <h3 class="copy">2024 © ZyFeronix Studio</h3>
  </section>
  <script src="/assets/js/scripts.js"></script>
  <script src="/assets/js/jquery-3.7.1.min.js"></script>
  <script src="/assets/js/elevator.js"></script>
  <script>
    var elementButton = document.querySelector('.elevator');
    var elevator = new Elevator({
      element: elementButton,
      mainAudio: './assets/audio/elevator.mp3',
      endAudio: './assets/audio/ding.mp3'
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const commentForm = document.getElementById('commentForm');

      commentForm.addEventListener('submit', function(event) {
        event.preventDefault();

        const formData = new FormData(commentForm);
        const newComment = {};
        formData.forEach((value, key) => {
          newComment[key] = value;
        });

        newComment.pfp = newComment.pfp || "./assets/img/default.jpg";

        const comments = JSON.parse(localStorage.getItem('comments')) || {};
        const newCommentKey = `comment${Object.keys(comments).length + 1}`;
        comments[newCommentKey] = newComment;

        localStorage.setItem('comments', JSON.stringify(comments));
        window.location.reload();
      });

      async function loadComments() {
        try {
          const response = await fetch('https://raw.githubusercontent.com/AlexDeveloperUwU/alexdev-files/main/files/defaultComments.json');

          if (!response.ok) {
            throw new Error('No se pudieron cargar los comentarios');
          }

          const comentarios = await response.json();

          localStorage.setItem('comments', JSON.stringify(comentarios));

          console.log('Comentarios cargados exitosamente desde GitHub:', comentarios);

          addCommentsToHTML(comentarios);
        } catch (error) {
          console.error('Error al cargar los comentarios desde GitHub:', error.message);
        }
      }

      if (!localStorage.getItem('comments')) {
        loadComments();
      } else {
        const comments = JSON.parse(localStorage.getItem('comments'));
        addCommentsToHTML(comments);
      }

      function addCommentsToHTML(comments) {
        const commentsContainer = document.querySelector('.opinions-container');

        Object.keys(comments).forEach(function(commentKey) {
          const comment = comments[commentKey];
          const isDefaultPfp = comment.pfp === "./assets/img/default.jpg";
          const deleteButtonHTML = isDefaultPfp ? `<i class="delete-btn far fa-trash-alt" onclick="deleteComment('${commentKey}')"></i>` : '';
          const commentHTML = `
        <div class="opinion">
          <div class="user-info">
            <img src="${comment.pfp}" alt="${comment.name}">
            <span class="user-name">${comment.name}</span>&nbsp;
            ${deleteButtonHTML}
          </div>
          <div class="stars">
            ${generateStars(comment.review)}
          </div>
          <p class="comment">${comment.description}</p>
        </div>
      `;
          commentsContainer.insertAdjacentHTML('beforeend', commentHTML);
        });
      }
    });


    function generateStars(review) {
      let starsHTML = '';
      const numStars = parseInt(review);
      for (let i = 0; i < 5; i++) {
        if (i < numStars) {
          starsHTML += '<i class="fas fa-star"></i>';
        } else {
          starsHTML += '<i class="far fa-star"></i>';
        }
      }
      return starsHTML;
    }

    function deleteComment(commentKey) {
      const comments = JSON.parse(localStorage.getItem('comments'));
      delete comments[commentKey];
      localStorage.setItem('comments', JSON.stringify(comments));
      window.location.reload();
    }
  </script>
</body>

</html>